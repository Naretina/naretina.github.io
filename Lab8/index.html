<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="https://d3js.org/d3.v7.min.js"></script>
	<title>D3 Geospatial Map</title>
</head>
<body>
<!-- Create your own geomap or dashboard. This implementation does not have to be the same as your
sketches from Task 2. It doesn't need to include multiple data attributes -
having the COVID19 # is sufficient. Also replicating the graphs is okay. The point here is to practice
to see how to do this in D3 (or Python, or Chart.js, or Tableau) -->
<!-- This data does NOT match what I did for tasks one and two at all. Treat them more as practice. -->
    <div id="chart" style="width: 600px; height: 600px;"></div>
    <script>
        async function program() {

            //step 1: load the dataset
            //data source: https://github.com/codeforgermany/click_that_hood/blob/master/public/data/columbus.geojson
            var data = await d3.json("columbus.geojson");
            console.log(data);
            // Random numbers inspired from: https://usafacts.org/visualizations/coronavirus-covid-19-spread-map/state/ohio/
            var info = await d3.json("specializedCovid.json")
            console.log(info);

            //step 2: create the SVG 
            var width = 600,
                height = 600;

            var svg = d3.select("#chart")
                .append("svg")
                .attr("width", width)
                .attr("height", height);


            //step 3: create the geoPath() and specify the projection configurations
            var projection = d3.geoMercator()
                .scale(50000)
                .center([-82.98, 39.98]) //[lon, lat]
                .translate([width / 2, height / 2]); //center of projection is located on the screen (with a [x, y] array)

            var geoGenerator = d3.geoPath()
                .projection(projection);

            //psuedo color mapping
            const colorScale = d3.scaleSequential()
                .interpolator(d3.interpolateBlues)
                .domain([1, 30])

            // Draw the map
            var map = svg.append("g")
                .selectAll("path")
                .data(data.features)
                .join("path")
                // draw each county
                .attr("d", function (d) {
                    return geoGenerator(d);
                })
                .style("stroke", "#aaa")
                .attr("opacity", 0.7)
                .attr("fill", function (d) {
                    return colorScale(d.properties.name.length);
                })
                .on("mouseover", function (event, d) {
                    console.log(d.properties.name);
                    d3.select(this).attr("fill", '#f8f7cc');
                })
                .on("mouseleave", function (event, d) {
                    console.log(colorScale(d.properties.name.length)); // TEST what this outputs
                    d3.select(this).attr("fill", colorScale(d.properties.name.length));
                })

        }

        program();
    </script>
</body>
</html>
